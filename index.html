<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Cybersecurity mindmap</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script type='text/javascript' src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
</head>
<body>
    <header>
        <nav>
            <ul class="nav-list">
                <li><a href="#home">Cybersecurity</a></li>
                <li><a href="#cu2">Course unit 2</a></li>
                <li><a href="#cu3">Course unit 3</a></li>
                <li><a href="#cu4">Course unit 4</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="mindmap-section">
            <h2>Cybersecurity<br/>Mind Map</h2>
            <div class="button-group">
                <button id="nightModeButton" class="night-toggle" aria-label="Toggle Night Mode">
                    <svg viewBox="0 0 24 24" class="moon-icon">
                        <path d="M21 12.79A9 9 0 0111.21 3a7 7 0 109.79 9.79z" />
                    </svg>
                </button>

                <div class="inbuttons">
                    <button class="toggle-button active fh" id="circularView">Circular View</button>
                    <button class="toggle-button fh" id="timelineView">Timeline View</button>
                </div>

                <button id="toggleExtraEdges" class="text-toggle">Extra Connections</button>
            </div>
            <div id="mindmap" style="height: 600px;"></div>
        </section>
    </main>

    <script>
    document.addEventListener("DOMContentLoaded", function () {
        var container = document.getElementById("mindmap");
        var circularButton = document.getElementById("circularView");
        var timelineButton = document.getElementById("timelineView");
        var toggleExtraButton = document.getElementById("toggleExtraEdges");
        var nightModeButton = document.getElementById("nightModeButton");

        var nodes = new vis.DataSet();
        var edges = new vis.DataSet();
        

        // ---------------------------------
      // Extra edges for toggling
      // ---------------------------------
      // For example, let's say you want extra connections between:
      //   - The "Cybersecurity" center node (id=1) and Week 2 (id=3)
      //   - "Week 2" (id=3) and "Week 3" (id=4)
      //   - A random topic within Week 4 to a random topic within Week 7
      // Adjust these IDs and connections however you prefer:
      var extraEdges = [
      ];
      
      // Whether extra edges are currently visible
      let extraEdgesVisible = false;

      // --- NIGHT MODE TOGGLE LOGIC ---
      nightModeButton.addEventListener("click", function () {
        document.body.classList.toggle("night-mode");
      });

        function getTopicsForWeek(week) {
            const topics = {
                1: ["Introduction \nto Course", "What is \nCybersecurity?", "Cybersecurity \nDomains", "Security: Past \nand Present", "Scope of \nCybersecurity", "Course \nRoadmap", "Cybersecurity \nThreats", "Security \nProperties", "Achieving \nSecurity", "Security \nModels"],
                2: ["Introduction \nto Cryptography", "Symmetric-Key \nCiphers", "Block Ciphers \n& Design", "Stream \nCiphers", "Encryption \nModes", "Security \nConsiderations"],
                3: ["Public-Key \nCryptography", "Mathematical \nFoundations", "RSA \nAlgorithm", "Hybrid \nCryptosystems", "Digital \nSignatures"],
                4: ["Introduction to \nCryptographic Checksums", "Cryptographic \nHash Functions", "Message \nAuthentication Codes (MAC)", "Authenticated \nEncryption", "Authenticated Encryption \nwith Associated Data (AEAD)", "Security \nConsiderations"],
                5: ["Introduction to \nSecret Key Management", "Key Management \nIssues", "Session Key \nEstablishment", "Key Agreement \nProtocols", "Symmetric Key \nDistribution Protocols", "Security Considerations \nin Key Management"],
                6: ["Introduction to \nPublic Key \nInfrastructure (PKI)", "PKI Components \nand Entities", "Digital \nCertificates", "Certificate \nRevocation Lists (CRLs)", "Certificate Hierarchies \nand Trust Models", "PKI in \nReal-Life Applications", "EMV (Europay, \nMasterCard, and Visa)", "MasterCard SecureCode \nand 3-D Secure Model"],
                7: ["Introduction to \nAuthentication", "Authentication \nMethods", "Password-Based \nAuthentication", "Challenge-Response \nAuthentication Protocols", "Token-Based \nAuthentication", "Enterprise Authentication \nand Single Sign-On (SSO)", "Authentication in \nDistributed Environments"],
                8: ["Introduction to \nVPNs", "VPN \nTechnologies", "Types of \nVPNs", "Security Risks \nand Benefits of VPNs", "IP Security \n(IPSec) Overview", "IPSec Components \nand Session\n Establishment", "Authentication\n Methods \nin IPSec", "IPSec Modes: \nTransport vs. Tunnel", "IPSec Traffic \nSecurity Protocols", "IPSec Packet \nProcessing", "Combining \nESP and AH"],
                9: ["Introduction to \nEmail Security", "Comparison of \nPGP and S/MIME", "PGP (Pretty Good \nPrivacy) Overview", "Security Features \nand Services of PGP", "PGP Encryption \nProcess", "PGP Message \nFormat", "PGP Key \nManagement", "PGP Trust Model \n(Web-of-Trust)", "PGP Message \nTransmission and Reception"],
                10: ["Introduction to \nSoftware Security", "Part 1: \nMalware \n(Malicious Software)", "Part 2: Buffer \nOverflow Vulnerabilities"],
            };

            return topics[week] || [];
        }

        function createTimelineGraph() {
        nodes.clear();
        edges.clear();

        // Main Cybersecurity Node
        nodes.add({ id: 1, label: "Cybersecurity", shape: "circle", color: "#ff8c00", size: 60, font: { size: 38 }, x: 0, y: 0 });

        let xSpacing = 250; // Space between nodes horizontally
        let ySpacing = 400; // Vertical spacing for week nodes
        let topicRadius = 220; // Radius for circular subtopics

        let xPos = xSpacing; // Start position for empty nodes
        let yPos = 0; // Centerline

        edges.add({ from: 1, to: 1001 });//Link cybersec and first empty node

        
        
        for (let i = 1; i <= 10; i++) {
            let emptyNodeId = 1000 + i; // Unique empty node ID
            let weekNodeId = i + 1;

            // Add an empty node between cybersecurity and week nodes
            nodes.add({ id: emptyNodeId, label: "", shape: "circle", color: "#d3d3d3", size: 20, x: xPos, y: yPos });
            edges.add({ from: emptyNodeId - 1, to: emptyNodeId });

            // Alternate week node placement (odd: above, even: below)
            let weekY = (i % 2 === 0) ? yPos + ySpacing : yPos - ySpacing;
            nodes.add({ id: weekNodeId, label: `Week ${i}`, color: "#6fa3ef", size: 35, font: { size: 25 }, x: xPos, y: weekY });
            edges.add({ from: emptyNodeId, to: weekNodeId });

            // Add topics in a circular layout around the week node
            let topics = getTopicsForWeek(i);
            let angleStep = (2 * Math.PI) / topics.length; // Angle between topics

            topics.forEach((topic, index) => {
                let topicAngle = angleStep * (index-1.5);
                let topicX = xPos + Math.cos(topicAngle) * topicRadius;
                let topicY = weekY + Math.sin(topicAngle) * topicRadius;
                let topicId = weekNodeId * 20 + index;

                nodes.add({ id: topicId, label: topic, color: "#77dd77", size: 25, font: { size: 18 }, x: topicX, y: topicY });
                edges.add({ from: weekNodeId, to: topicId });
            });

            // Move to the right for the next set of nodes
            xPos += xSpacing*1.5;
    }
    let week10Part1 = ["Understanding \nMalware", "Malware \nClassification", "Types of \nMalware", "Advanced Persistent \nThreats (APTs)", "Defensive Measures \nAgainst Malware"]
        let week10Part2 = ["Understanding \nBuffer Overflows", "Program Memory \nLayout", "Stack-Based Buffer \nOverflow Attacks", "Buffer Overflow \nExploitation Techniques", "Defenses Against \nBuffer \nOverflow Attacks"]
        let week10Part1topicAngleStep = (2 * Math.PI) / (week10Part1.length*2);
        week10Part1.forEach((week10Part1topic, index) => {
            let week10Part1topicAngle = (week10Part1topicAngleStep * (index-3));
            let week10Part1topicX = nodes.get(221).x + Math.cos(week10Part1topicAngle) * 300;
            let week10Part1topicY = nodes.get(221).y + Math.sin(week10Part1topicAngle) * 300;
            let week10Part1topicId = 223 + index;
            nodes.add({ id: week10Part1topicId, label: week10Part1topic, color: "#77dd77", size: 25, font: { size: 22 }, x: week10Part1topicX, y: week10Part1topicY });
            edges.add({ from: 221, to: week10Part1topicId });
            });
        let week10Part2topicAngleStep = (2 * Math.PI) / (week10Part2.length*1.5);
        week10Part2.forEach((week10Part2topic, index) => {
            let week10Part2topicAngle = (week10Part2topicAngleStep * (index));
            let week10Part2topicX = nodes.get(222).x + Math.cos(week10Part2topicAngle) * 300;
            let week10Part2topicY = nodes.get(222).y + Math.sin(week10Part2topicAngle) * 300;
            let week10Part2topicId = 228 + index;
            nodes.add({ id: week10Part2topicId, label: week10Part2topic, color: "#77dd77", size: 25, font: { size: 22 }, x: week10Part2topicX, y: week10Part2topicY });
            edges.add({ from: 222, to: week10Part2topicId });
            });
}

        
        function createCircularGraph() {
            nodes.clear();
            edges.clear();
            
            nodes.add({ id: 1, label: "Cybersecurity", shape: "ellipse", color: "#6B2C91", size: 70, font: { size: 90, color:"#ffffff" }, x: 0, y: 0 });
            let angleStep = (2 * Math.PI) / 10;
            let radius = 1300;

            let week10Part1 = ["Understanding \nMalware", "Malware \nClassification", "Types of \nMalware", "Advanced Persistent \nThreats (APTs)", "Defensive Measures \nAgainst Malware"]
            let week10Part2 = ["Understanding \nBuffer Overflows", "Program Memory \nLayout", "Stack-Based Buffer \nOverflow Attacks", "Buffer Overflow \nExploitation Techniques", "Defenses Against \nBuffer \nOverflow Attacks"]
            let week10Part1topicAngleStep = (2 * Math.PI) / (week10Part1.length*2);
            week10Part1.forEach((week10Part1topic, index) => {
                let week10Part1topicAngle = (week10Part1topicAngleStep * index)+(week10Part1topicAngleStep*2.5);
                let week10Part1topicX = -1277 + Math.cos(week10Part1topicAngle) * 350;
                let week10Part1topicY = -1162 + Math.sin(week10Part1topicAngle) * 350;
                let week10Part1topicId = 223 + index;
                nodes.add({ id: week10Part1topicId, label: week10Part1topic+week10Part1topicId.toString(), color: "#f9f6cf", size: 25, font: { size: 22 }, x: week10Part1topicX, y: week10Part1topicY });
                edges.add({ from: 221, to: week10Part1topicId });
                });
            let week10Part2topicAngleStep = (2 * Math.PI) / (week10Part2.length*1.5);
            week10Part2.forEach((week10Part2topic, index) => {
                let week10Part2topicAngle = (week10Part2topicAngleStep * index)+(week10Part2topicAngleStep*3.5);
                let week10Part2topicX = -1030 + Math.cos(week10Part2topicAngle) * 400;
                let week10Part2topicY = -1715 + Math.sin(week10Part2topicAngle) * 400;
                let week10Part2topicId = 228 + index;
                nodes.add({ id: week10Part2topicId, label: week10Part2topic+week10Part2topicId.toString(), color: "#f9f6cf", size: 25, font: { size: 22 }, x: week10Part2topicX, y: week10Part2topicY });
                edges.add({ from: 222, to: week10Part2topicId });
                });

            for (let i = 1; i <= 10; i++) {
                let angle = (angleStep * (i - 1))-(angleStep*2.5);
                let weekNodeId = i + 1;
                let x;
                let y;
                if (i%2==1) {
                    x = 0.7*(Math.cos(angle) * radius);
                    y = 0.7*(Math.sin(angle) * radius);
                }
                else{
                    x = 1.3*(Math.cos(angle) * radius);
                    y = 1.3*(Math.sin(angle) * radius);
                }
                nodes.add({ id: weekNodeId, label: `Week ${i}`, color: "#D5B8E7", size: 60, shape: "ellipse", font: { size: 85 , color:"#1C1C1C"}, x: x, y: y });
                edges.add({ from: 1, to: weekNodeId });
                
                let topics = getTopicsForWeek(i);
                let topicAngleStep = (2 * Math.PI) / topics.length;
                let topicRadius = 350;
                topics.forEach((topic, index) => {
                    let topicAngle = (topicAngleStep * index)-(topicAngleStep*2.8);
                    let topicX = Math.round(x + Math.cos(topicAngle) * topicRadius);
                    let topicY = Math.round(y + Math.sin(topicAngle) * topicRadius); 
                    let topicId = weekNodeId * 20 + index;
                    nodes.add({ id: topicId, label: topic, color: "#f9f6cf", size: 25, font: { size: 30, color:"#1C1C1C" }, x: topicX, y: topicY });
                    edges.add({ from: weekNodeId, to: topicId });
                });
            }
            nodes.update({ id: 186, x: nodes.get(186).x - 60, y: nodes.get(186).y + 30 });
            

        }
        

        function createRelations() {
            //Connections for Cybersecurity Space
            extraEdges.push({ from: 42, to: 181, label: "Requires Secure Communication Channels", color: "#B0B0B0" }); // Links to "VPN Technologies" (Topic 9)
            extraEdges.push({ from: 42, to: 145, label: "Depends on PKI for Trust Management", color: "#B0B0B0" }); // Links to "PKI in Real-Life Applications" (Topic 7)
            extraEdges.push({ from: 42, to: 225, label: "Targets Protection Against Malware", color: "#B0B0B0" }); // Links to "Types of Malware" (Topic 11)
            extraEdges.push({ from: 42, to: 124, label: "Includes Key Distribution Mechanisms", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Topic 6)
            extraEdges.push({ from: 42, to: 84, label: "Employs Digital Signatures for Integrity", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 42, to: 102, label: "Utilizes MACs for Data Integrity", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 42, to: 161, label: "Encompasses Authentication Methods", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)
            extraEdges.push({ from: 42, to: 202, label: "Applies to PGP for Securing Emails", color: "#B0B0B0" }); // Links to "PGP (Pretty Good Privacy) Overview" (Topic 10)

            //Connections for Security:Past and Present
            extraEdges.push({ from: 43, to: 46, label: "Evolved into Threat Landscape Models", color: "#B0B0B0" }); // Links to "Cybersecurity Threats" (Topic 2)
            extraEdges.push({ from: 43, to: 60, label: "Progressed from Classical to Modern Cryptography", color: "#B0B0B0" }); // Links to "Introduction to Cryptography" (Topic 3)
            extraEdges.push({ from: 43, to: 181, label: "Led to Development of VPN Technologies", color: "#B0B0B0" }); // Links to "VPN Technologies" (Topic 9)
            extraEdges.push({ from: 43, to: 223, label: "Addresses Historical Malware Trends", color: "#B0B0B0" }); // Links to "Understanding Malware" (Topic 11)
            extraEdges.push({ from: 43, to: 124, label: "Resulted in Key Management Evolution", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Topic 6)
            extraEdges.push({ from: 43, to: 162, label: "Inspired Advanced Authentication Protocols", color: "#B0B0B0" }); // Links to "Password-Based Authentication" (Topic 8)
            extraEdges.push({ from: 43, to: 145, label: "Contributed to the Emergence of PKI Systems", color: "#B0B0B0" }); // Links to "PKI in Real-Life Applications" (Topic 7)

            //Connections for Cybersecurity Threats
            extraEdges.push({ from: 46, to: 223, label: "Includes Malware-Based Attacks", color: "#B0B0B0" }); // Links to "Understanding Malware" (Topic 11)
            extraEdges.push({ from: 46, to: 203, label: "Email is a Common Attack Vector", color: "#B0B0B0" }); // Links to "Security Features and Services of PGP" (Topic 10)
            extraEdges.push({ from: 46, to: 181, label: "Mitigated by VPN Technologies", color: "#B0B0B0" }); // Links to "VPN Technologies" (Topic 9)
            extraEdges.push({ from: 46, to: 160, label: "Exploits Weak Authentication", color: "#B0B0B0" }); // Links to "Introduction to Authentication" (Topic 8)
            extraEdges.push({ from: 46, to: 102, label: "Threatens Message Integrity", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 46, to: 125, label: "Requires Secure Key Management", color: "#B0B0B0" }); // Links to "Security Considerations in Key Management" (Topic 6)
            extraEdges.push({ from: 46, to: 84, label: "Countered with Digital Signatures", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)

            //Connections for Introduction to Cryptography
            extraEdges.push({ from: 60, to: 80, label: "Foundation for Public-Key Cryptography", color: "#B0B0B0" }); // Links to "Introduction to Public-Key Cryptography" (Topic 4)
            extraEdges.push({ from: 60, to: 102, label: "Basis for Message Authentication", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 60, to: 121, label: "Leads to Key Management Principles", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 60, to: 161, label: "Used in Authentication Methods", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)
            extraEdges.push({ from: 60, to: 202, label: "Utilized in PGP Encryption", color: "#B0B0B0" }); // Links to "PGP (Pretty Good Privacy) Overview" (Topic 10)

            //Connections for Symmetric-Key Ciphers
            extraEdges.push({ from: 61, to: 102, label: "Used to Construct MACs", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 61, to: 124, label: "Supports Symmetric Key Distribution", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Topic 6)
            extraEdges.push({ from: 61, to: 181, label: "Employed in VPN Data Encryption", color: "#B0B0B0" }); // Links to "VPN Technologies" (Topic 9)
            extraEdges.push({ from: 61, to: 204, label: "Provides PGP Message Confidentiality", color: "#B0B0B0" }); // Links to "PGP Encryption Process" (Topic 10)
            extraEdges.push({ from: 61, to: 227, label: "Encrypts Payload in Malware Defense", color: "#B0B0B0" }); // Links to "Defensive Measures Against Malware" (Topic 11)

            //Connections for Block Ciphers and Their Design
            extraEdges.push({ from: 62, to: 102, label: "Forms Basis of MAC Construction", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 62, to: 122, label: "Influences Secure Session Key Handling", color: "#B0B0B0" }); // Links to "Session Key Establishment" (Topic 6)
            extraEdges.push({ from: 62, to: 204, label: "Used in PGP Hybrid Encryption", color: "#B0B0B0" }); // Links to "PGP Encryption Process" (Topic 10)
            extraEdges.push({ from: 62, to: 181, label: "Encrypts VPN Payloads in IPSec", color: "#B0B0B0" }); // Links to "VPN Technologies" (Topic 9)
            extraEdges.push({ from: 62, to: 227, label: "Strengthens Software Against Attacks", color: "#B0B0B0" }); // Links to "Defensive Measures Against Malware" (Topic 11)

            //Connections for Stream Ciphers
            extraEdges.push({ from: 63, to: 102, label: "Used in Lightweight MAC Implementations", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 63, to: 124, label: "Applied in Symmetric Key Protocols", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Topic 6)
            extraEdges.push({ from: 63, to: 204, label: "Alternative to Block Ciphers in PGP", color: "#B0B0B0" }); // Links to "PGP Encryption Process" (Topic 10)
            extraEdges.push({ from: 63, to: 225, label: "Exploited or Defended in Malware Payloads", color: "#B0B0B0" }); // Links to "Types of Malware" (Topic 11)
            extraEdges.push({ from: 63, to: 181, label: "Used in VPN for Real-Time Encryption", color: "#B0B0B0" }); // Links to "VPN Technologies" (Topic 9)

            //Connections for Modes of Encryption
            extraEdges.push({ from: 64, to: 102, label: "Enhances MAC Security and Flexibility", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 64, to: 124, label: "Used in Symmetric Key Protocols", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Topic 6)
            extraEdges.push({ from: 64, to: 181, label: "Determines VPN Payload Handling", color: "#B0B0B0" }); // Links to "VPN Technologies" (Topic 9)
            extraEdges.push({ from: 64, to: 204, label: "Affects PGP Confidentiality Mechanisms", color: "#B0B0B0" }); // Links to "PGP Encryption Process" (Topic 10)
            extraEdges.push({ from: 64, to: 227, label: "Mitigates Risks in Software-Level Encryption", color: "#B0B0B0" }); // Links to "Defensive Measures Against Malware" (Topic 11)

            //Connections for Security Considerations
            extraEdges.push({ from: 65, to: 102, label: "Impact Hash-Based Integrity Schemes", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 65, to: 121, label: "Essential in Key Management Policies", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 65, to: 161, label: "Guides Selection of Authentication Methods", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)
            extraEdges.push({ from: 65, to: 203, label: "Drives Secure Email Design", color: "#B0B0B0" }); // Links to "Security Features and Services of PGP" (Topic 10)
            extraEdges.push({ from: 65, to: 227, label: "Influences Malware Defense Strategy", color: "#B0B0B0" }); // Links to "Defensive Measures Against Malware" (Topic 11)

            //Connections for Introduction to Public-Key Cryptography
            extraEdges.push({ from: 80, to: 100, label: "Requires Hashing for Digital Signatures", color: "#B0B0B0" }); // Links to "Introduction to Cryptographic Checksums" (Week 4)
            extraEdges.push({ from: 80, to: 120, label: "Used for Secure Key Transport", color: "#B0B0B0" }); // Links to "Introduction to Secret Key Management" (Week 5)
            extraEdges.push({ from: 80, to: 140, label: "Foundation of PKI", color: "#B0B0B0" }); // Links to "Introduction to Public Key Infrastructure (PKI)" (Week 6)
            extraEdges.push({ from: 80, to: 160, label: "Supports Entity Authentication", color: "#B0B0B0" }); // Links to "Introduction to Authentication" (Week 7)
            extraEdges.push({ from: 80, to: 180, label: "Used in Secure VPN Communications", color: "#B0B0B0" }); // Links to "Introduction to VPNs" (Week 8)
            extraEdges.push({ from: 80, to: 200, label: "Used in Email Encryption & Signing", color: "#B0B0B0" }); // Links to "Introduction to Email Security" (Week 9)
            extraEdges.push({ from: 80, to: 220, label: "Targets of PKC-based Exploits", color: "#B0B0B0" }); // Links to "Introduction to Software Security" (Week 10)
            extraEdges.push({ from: 80, to: 61, label: "Addresses Limitations of Symmetric-Key Ciphers", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Week 2)
            extraEdges.push({ from: 80, to: 46, label: "Solves Secure Key Exchange Problem", color: "#B0B0B0" }); // Links to "Cybersecurity Threats" (Week 1)

            //Connections for Mathematical Foundations of PKC
            extraEdges.push({ from: 81, to: 101, label: "Used in Secure Hash Algorithms", color: "#B0B0B0" }); // Connects to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 81, to: 141, label: "Foundation for Public Key Infrastructure", color: "#B0B0B0" }); // Connects to "PKI Components and Entities" (Topic 7)
            extraEdges.push({ from: 81, to: 163, label: "Supports Challenge-Response Protocols", color: "#B0B0B0" }); // Connects to "Challenge-Response Authentication Protocols" (Topic 8)
            extraEdges.push({ from: 81, to: 185, label: "Underlying Math for IPSec Protocols", color: "#B0B0B0" }); // Connects to "IPSec Components and Session Establishment" (Topic 9)
            extraEdges.push({ from: 81, to: 203, label: "Used in Digital Signature Services", color: "#B0B0B0" }); // Connects to "Security Features and Services of PGP" (Topic 10)

            //Connections for RSA Algorithm
            extraEdges.push({ from: 82, to: 124, label: "Used for Secure Key Distribution", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Topic 6)
            extraEdges.push({ from: 82, to: 142, label: "Provides Foundation for Digital Certificates", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 82, to: 204, label: "Encrypts Session Key in Email Security", color: "#B0B0B0" }); // Links to "PGP Encryption Process" (Topic 10)
            extraEdges.push({ from: 82, to: 166, label: "Supports Public Key Authentication", color: "#B0B0B0" }); // Links to "Authentication in Distributed Environments" (Topic 8)
            extraEdges.push({ from: 82, to: 188, label: "Supports Key Transport in IPSec", color: "#B0B0B0" }); // Links to "IPSec Traffic Security Protocols" (Topic 9)

            //Connections for Hybrid Cryptosystems
            extraEdges.push({ from: 83, to: 61, label: "Uses Symmetric Ciphers for Bulk Data Encryption", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Topic 3)
            extraEdges.push({ from: 83, to: 124, label: "Securely Distributes Session Keys via Public-Key Encryption", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Topic 6)
            extraEdges.push({ from: 83, to: 163, label: "Session Keys Enable Authentication Protocols", color: "#B0B0B0" }); // Links to "Challenge-Response Authentication Protocols" (Topic 8)
            extraEdges.push({ from: 83, to: 204, label: "Employed in PGP for Efficient Message Encryption", color: "#B0B0B0" }); // Links to "PGP Encryption Process" (Topic 10)
            extraEdges.push({ from: 83, to: 185, label: "Key Exchange in VPNs Relies on Hybrid Encryption", color: "#B0B0B0" }); // Links to "IPSec Components and Session Establishment" (Topic 9)

            //Connections for Digital Signatures
            extraEdges.push({ from: 84, to: 101, label: "Uses Hashing for Message Integrity", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 84, to: 125, label: "Depends on Secure Key Management", color: "#B0B0B0" }); // Links to "Security Considerations in Key Management" (Topic 6)
            extraEdges.push({ from: 84, to: 144, label: "Relies on Trust Models for Validation", color: "#B0B0B0" }); // Links to "Certificate Hierarchies and Trust Models" (Topic 7)
            extraEdges.push({ from: 84, to: 166, label: "Supports Non-Repudiation in Authentication", color: "#B0B0B0" }); // Links to "Authentication in Distributed Environments" (Topic 8)
            extraEdges.push({ from: 84, to: 203, label: "Enables Message Origin Authentication", color: "#B0B0B0" }); // Links to "Security Features and Services of PGP" (Topic 10)

            //Connections for Introduction to Cryptographic Checksums
            extraEdges.push({ from: 100, to: 64, label: "Supports Message Integrity", color: "#B0B0B0" }); // Links to "Modes of Encryption" (Topic 3)
            extraEdges.push({ from: 100, to: 84, label: "Enables Non-Repudiation via Digital Signatures", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 100, to: 121, label: "Relies on Secure Key Handling for MACs", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 100, to: 162, label: "Verifies Password Integrity via Hashing", color: "#B0B0B0" }); // Links to "Password-Based Authentication" (Topic 7)
            extraEdges.push({ from: 100, to: 203, label: "Used for Integrity in PGP Signatures", color: "#B0B0B0" }); // Links to "Security Features and Services of PGP" (Topic 10)
            extraEdges.push({ from: 100, to: 227, label: "Detects Tampering from Malware Payloads", color: "#B0B0B0" }); // Links to "Defensive Measures Against Malware" (Topic 11)

            //Connections for Cryptographic Hash Functions
            extraEdges.push({ from: 101, to: 84, label: "Used in Digital Signatures", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 101, to: 142, label: "Supports Integrity in Digital Certificates", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 101, to: 162, label: "Used in Hashed Password Authentication", color: "#B0B0B0" }); // Links to "Password-Based Authentication" (Topic 8)
            extraEdges.push({ from: 101, to: 203, label: "Provides Message Integrity in PGP", color: "#B0B0B0" }); // Links to "Security Features and Services of PGP" (Topic 10)
            extraEdges.push({ from: 101, to: 225, label: "Targeted by Collision-Based Attacks in Malware", color: "#B0B0B0" }); // Links to "Types of Malware" (Topic 11)

            //Connections for Message Authentication Codes (MAC)
            extraEdges.push({ from: 102, to: 61, label: "Built from Symmetric Key Primitives", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Week 2, Topic 3)
            extraEdges.push({ from: 102, to: 84, label: "Enhanced with Digital Signatures for Integrity", color: "#B0B0B0" }); // Links to "Digital Signatures" (Week 3, Topic 4)
            extraEdges.push({ from: 102, to: 124, label: "Key Distribution Required for MAC Use", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Week 5, Topic 6)
            extraEdges.push({ from: 102, to: 189, label: "Used in VPN Packet Authentication", color: "#B0B0B0" }); // Links to "IPSec Packet Processing" (Week 8, Topic 9)
            extraEdges.push({ from: 102, to: 203, label: "Provides Message Integrity in PGP", color: "#B0B0B0" }); // Links to "Security Features and Services of PGP" (Week 9, Topic 10)
            extraEdges.push({ from: 102, to: 227, label: "Defends Against Malware Tampering", color: "#B0B0B0" }); // Links to "Defensive Measures Against Malware" (Week 10, Topic 11)

            //Connections for Authenticated Encryption
            extraEdges.push({ from: 103, to: 61, label: "Built on Symmetric-Key Ciphers", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Week 2)
            extraEdges.push({ from: 103, to: 83, label: "Enhances Hybrid Cryptosystems", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Week 3)
            extraEdges.push({ from: 103, to: 122, label: "Requires Secure Session Key Establishment", color: "#B0B0B0" }); // Links to "Session Key Establishment" (Week 5)
            extraEdges.push({ from: 103, to: 142, label: "Used with Digital Certificates for Authenticity", color: "#B0B0B0" }); // Links to "Digital Certificates" (Week 6)
            extraEdges.push({ from: 103, to: 164, label: "Supports Secure Token-Based Authentication", color: "#B0B0B0" }); // Links to "Token-Based Authentication" (Week 7)
            extraEdges.push({ from: 103, to: 188, label: "Applied in IPSec Traffic Security Protocols", color: "#B0B0B0" }); // Links to "IPSec Traffic Security Protocols" (Week 8)
            extraEdges.push({ from: 103, to: 203, label: "Used in PGP for Confidentiality and Integrity", color: "#B0B0B0" }); // Links to "Security Features and Services of PGP" (Week 9)
            extraEdges.push({ from: 103, to: 227, label: "Prevents Tampering in Malware Payloads", color: "#B0B0B0" }); // Links to "Defensive Measures Against Malware" (Week 10)

            //Connections for Authenticated Encryption with Associated Data (AEAD)
            extraEdges.push({ from: 104, to: 62, label: "Uses Block Cipher Modes for Encryption", color: "#B0B0B0" }); // AEAD to "Block Ciphers and Their Design" (Topic 3)
            extraEdges.push({ from: 104, to: 121, label: "Requires Secure Key Management", color: "#B0B0B0" }); // AEAD to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 104, to: 163, label: "Supports Entity Authentication via Integrity Checks", color: "#B0B0B0" }); // AEAD to "Challenge-Response Authentication Protocols" (Topic 8)
            extraEdges.push({ from: 104, to: 188, label: "Used in IPSec ESP for Secure Packet Transmission", color: "#B0B0B0" }); // AEAD to "IPSec Traffic Security Protocols" (Topic 9)

            //Connections for Security Considerations
            extraEdges.push({ from: 105, to: 125, label: "Informs Risks in Symmetric Key Use", color: "#B0B0B0" }); // Links to "Security Considerations in Key Management" (Topic 6)
            extraEdges.push({ from: 105, to: 142, label: "Supports PKI Certificate Confidentiality", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 105, to: 162, label: "Depends on Strength of Passwords", color: "#B0B0B0" }); // Links to "Password-Based Authentication" (Topic 8)
            extraEdges.push({ from: 105, to: 183, label: "Addresses VPN Risks and Benefits", color: "#B0B0B0" }); // Links to "Security Risks and Benefits of VPNs" (Topic 9)
            extraEdges.push({ from: 105, to: 204, label: "Applies to PGP Encryption Methods", color: "#B0B0B0" }); // Links to "PGP Encryption Process" (Topic 10)
            extraEdges.push({ from: 105, to: 227, label: "Relevant for Malware Defense Planning", color: "#B0B0B0" }); // Links to "Defensive Measures Against Malware" (Topic 11)

            //Connections for Introduction to Secret Key Management
            extraEdges.push({ from: 120, to: 61, label: "Requires Knowledge of Symmetric Ciphers", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Topic 3)
            extraEdges.push({ from: 120, to: 83, label: "Supports Hybrid Encryption in PKC", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Topic 4)
            extraEdges.push({ from: 120, to: 102, label: "Relies on MACs and Integrity Mechanisms", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 120, to: 140, label: "Supports Key Lifecycle in PKI", color: "#B0B0B0" }); // Links to "Introduction to Public Key Infrastructure (PKI)" (Topic 7)
            extraEdges.push({ from: 120, to: 163, label: "Enables Challenge-Response Protocols", color: "#B0B0B0" }); // Links to "Challenge-Response Authentication Protocols" (Topic 8)
            extraEdges.push({ from: 120, to: 185, label: "Supports IPSec Key Exchange", color: "#B0B0B0" }); // Links to "IPSec Components and Session Establishment" (Topic 9)
            extraEdges.push({ from: 120, to: 207, label: "Essential for Web-of-Trust Model", color: "#B0B0B0" }); // Links to "PGP Trust Model (Web-of-Trust)" (Topic 10)

            //Connections for Key Management Issues
            extraEdges.push({ from: 121, to: 61, label: "Relies on Secure Symmetric Keys", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Topic 3)
            extraEdges.push({ from: 121, to: 83, label: "Supports Secure Session Key Transport", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Topic 4)
            extraEdges.push({ from: 121, to: 101, label: "Uses Hashing for Key Authentication", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 121, to: 141, label: "Enables Public Key Validation", color: "#B0B0B0" }); // Links to "PKI Components and Entities" (Topic 7)
            extraEdges.push({ from: 121, to: 164, label: "Used in Token-Based Authentication", color: "#B0B0B0" }); // Links to "Token-Based Authentication" (Topic 8)
            extraEdges.push({ from: 121, to: 185, label: "Supports Secure VPN Sessions", color: "#B0B0B0" }); // Links to "IPSec Components and Session Establishment" (Topic 9)
            extraEdges.push({ from: 121, to: 206, label: "Critical for PGP Key Management", color: "#B0B0B0" }); // Links to "PGP Key Management" (Topic 10)

            //Connections for Session Key Establishment
            extraEdges.push({ from: 122, to: 83, label: "Uses Asymmetric Encryption in Hybrid Systems", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Topic 4)
            extraEdges.push({ from: 122, to: 144, label: "Relies on Public Key Infrastructure for Secure Key Exchange", color: "#B0B0B0" }); // Links to "Certificate Hierarchies and Trust Models" (Topic 7)
            extraEdges.push({ from: 122, to: 166, label: "Supports Authentication in Distributed Systems", color: "#B0B0B0" }); // Links to "Authentication in Distributed Environments" (Topic 8)
            extraEdges.push({ from: 122, to: 185, label: "Implemented in IPSec for Secure Communications", color: "#B0B0B0" }); // Links to "IPSec Components and Session Establishment" (Topic 9)
            extraEdges.push({ from: 122, to: 204, label: "Used in PGP for Email Message Confidentiality", color: "#B0B0B0" }); // Links to "PGP Encryption Process" (Topic 10)

            //Connections for Key Agreement Protocols
            extraEdges.push({ from: 123, to: 83, label: "Relies on Public-Key Exchange", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Topic 4)
            extraEdges.push({ from: 123, to: 84, label: "Enables Secure Key Establishment", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 123, to: 142, label: "Supports Digital Certificates", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 123, to: 144, label: "Facilitates Trust Models", color: "#B0B0B0" }); // Links to "Certificate Hierarchies and Trust Models" (Topic 7)
            extraEdges.push({ from: 123, to: 185, label: "Used in IPSec Session Setup", color: "#B0B0B0" }); // Links to "IPSec Components and Session Establishment" (Topic 9)
            extraEdges.push({ from: 123, to: 187, label: "Secures Tunnel Negotiation", color: "#B0B0B0" }); // Links to "IPSec Modes: Transport vs. Tunnel" (Topic 9)

            //Connections for Symmetric Key Distribution Protocols
            extraEdges.push({ from: 124, to: 62, label: "Depends on Strong Cryptographic Algorithms", color: "#B0B0B0" }); // Link to "Block Ciphers and Their Design" (Topic 3)
            extraEdges.push({ from: 124, to: 64, label: "Uses Encryption Modes for Secure Key Transport", color: "#B0B0B0" }); // Link to "Modes of Encryption" (Topic 3)
            extraEdges.push({ from: 124, to: 83, label: "Can Use Public-Key Encryption for Distribution", color: "#B0B0B0" }); // Link to "Hybrid Cryptosystems" (Topic 4)
            extraEdges.push({ from: 124, to: 102, label: "Uses MACs for Key Integrity Verification", color: "#B0B0B0" }); // Link to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 124, to: 163, label: "Can Be Authenticated via Challenge-Response", color: "#B0B0B0" }); // Link to "Challenge-Response Authentication Protocols" (Topic 8)
            extraEdges.push({ from: 124, to: 184, label: "Employed in Secure VPN Session Establishment", color: "#B0B0B0" }); // Link to "IP Security (IPSec) Overview" (Topic 9)

            //Connections for Security Considerations in Key Management
            extraEdges.push({ from: 125, to: 65, label: "Informs Secure Key Generation and Use", color: "#B0B0B0" }); // Links to "Security Considerations" (Topic 3)
            extraEdges.push({ from: 125, to: 102, label: "Ensures Integrity of Keyed Authentication", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 125, to: 141, label: "Supports PKI Private Key Security", color: "#B0B0B0" }); // Links to "PKI Components and Entities" (Topic 7)
            extraEdges.push({ from: 125, to: 161, label: "Enhances Credential Security", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)
            extraEdges.push({ from: 125, to: 185, label: "Used in VPN Session Key Handling", color: "#B0B0B0" }); // Links to "IPSec Components and Session Establishment" (Topic 9)
            extraEdges.push({ from: 125, to: 206, label: "Required for Secure PGP Key Management", color: "#B0B0B0" }); // Links to "PGP Key Management" (Topic 10)
            extraEdges.push({ from: 125, to: 227, label: "Mitigates Key Disclosure by Malware", color: "#B0B0B0" }); // Links to "Defensive Measures Against Malware" (Topic 11)

            //Connections for Introduction to Public Key Infrastructure (PKI)
            extraEdges.push({ from: 140, to: 84, label: "Enables Digital Signatures with Certificate Binding", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 140, to: 125, label: "Requires Secure Private Key Handling", color: "#B0B0B0" }); // Links to "Security Considerations in Key Management" (Topic 6)
            extraEdges.push({ from: 140, to: 184, label: "Used in Secure VPN Communication", color: "#B0B0B0" }); // Links to "IP Security (IPSec) Overview" (Topic 9)
            extraEdges.push({ from: 140, to: 207, label: "Contrasts with Web-of-Trust in PGP", color: "#B0B0B0" }); // Links to "PGP Trust Model (Web-of-Trust)" (Topic 10)
            extraEdges.push({ from: 140, to: 161, label: "Relies on Authentication for Certificate Validation", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)

            //Connections for PKI Components and Entities
            extraEdges.push({ from: 141, to: 84, label: "Used to Support Digital Signatures", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 141, to: 161, label: "Enables Certificate-Based Authentication", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)
            extraEdges.push({ from: 141, to: 185, label: "Provides Trust Model for IPSec", color: "#B0B0B0" }); // Links to "IPSec Components and Session Establishment" (Topic 9)
            extraEdges.push({ from: 141, to: 201, label: "Foundation for S/MIME Certificates", color: "#B0B0B0" }); // Links to "Comparison of PGP and S/MIME" (Topic 10)
            extraEdges.push({ from: 141, to: 101, label: "Ensures Authenticity with Cryptographic Hash Functions", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 141, to: 121, label: "Requires Secure Key Management", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)

            //Connections for Digital certificates
            extraEdges.push({ from: 142, to: 84, label: "Enables Trust in Public Key Ownership", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 142, to: 102, label: "Supports Key Authentication and Integrity", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 142, to: 161, label: "Used in Authentication Solutions (X.509)", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)
            extraEdges.push({ from: 142, to: 186, label: "Used to Authenticate Users and Devices", color: "#B0B0B0" }); // Links to "Authentication Methods in IPSec" (Topic 9)
            extraEdges.push({ from: 142, to: 201, label: "Used in Secure Email (S/MIME Certificates)", color: "#B0B0B0" }); // Links to "Comparison of PGP and S/MIME" (Topic 10)

            //Connections for Certificate Revocation Lists (CRLs)
            extraEdges.push({ from: 143, to: 84, label: "Revocation Ensures Signature Trustworthiness", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 143, to: 103, label: "Supports Message Non-repudiation", color: "#B0B0B0" }); // Links to "Authenticated Encryption" (Topic 5)
            extraEdges.push({ from: 143, to: 164, label: "Essential for Token Validation", color: "#B0B0B0" }); // Links to "Token-Based Authentication" (Topic 8)
            extraEdges.push({ from: 143, to: 203, label: "Validates Sender in Email Systems", color: "#B0B0B0" }); // Links to "Security Features and Services of PGP" (Topic 10)
            extraEdges.push({ from: 143, to: 185, label: "Used in IPSec Certificate Management", color: "#B0B0B0" }); // Links to "IPSec Components and Session Establishment" (Topic 9)

            //Connections for Certificate Hierarchies and Trust Models
            extraEdges.push({ from: 144, to: 121, label: "Requires Secure Key Management", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 144, to: 84, label: "Supports Trust Through Digital Signatures", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 144, to: 207, label: "Forms Basis for PGP Trust Models", color: "#B0B0B0" }); // Links to "PGP Trust Model (Web-of-Trust)" (Topic 10)
            extraEdges.push({ from: 144, to: 166, label: "Supports Authentication in Distributed Systems", color: "#B0B0B0" }); // Links to "Authentication in Distributed Environments" (Topic 8)

            //Connections for PKI in Real-Life Applications
            extraEdges.push({ from: 145, to: 164, label: "Supports Smartcard-Based Payments", color: "#B0B0B0" }); // Links to "Token-Based Authentication" (Topic 8)
            extraEdges.push({ from: 145, to: 201, label: "Used in Email Security (S/MIME)", color: "#B0B0B0" }); // Links to "Comparison of PGP and S/MIME" (Topic 10)
            extraEdges.push({ from: 145, to: 186, label: "Used for VPN Authentication (IPSec)", color: "#B0B0B0" }); // Links to "Authentication Methods in IPSec" (Topic 9)
            extraEdges.push({ from: 145, to: 84, label: "Enables Secure Web Transactions", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 145, to: 47, label: "Depends on Trust in Public Keys", color: "#B0B0B0" }); // Links to "Security Properties" (Topic 2)

            //Connections for EMV (Europay, MasterCard, and Visa)
            extraEdges.push({ from: 146, to: 142, label: "Relies on Digital Certificates for Card Authentication", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 146, to: 84, label: "Enhances Secure Transactions with PKI Support", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 146, to: 121, label: "Requires Strong Key Management for Card Credentials", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 146, to: 161, label: "Incorporates Token-Based Authentication for Cardholders", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)

            //Connections for MasterCard SecureCode and 3-D Secure Model
            extraEdges.push({ from: 147, to: 164, label: "Implements Token-Based Authentication", color: "#B0B0B0" }); // Links to "Token-Based Authentication" (Topic 8)
            extraEdges.push({ from: 147, to: 84, label: "Uses Digital Signatures for Authenticity", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 147, to: 102, label: "Employs Message Authentication Codes", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 147, to: 141, label: "Relies on Trusted Certificate Authorities", color: "#B0B0B0" }); // Links to "PKI Components and Entities" (Topic 7)
            extraEdges.push({ from: 147, to: 47, label: "Addresses Confidentiality and Integrity in Transactions", color: "#B0B0B0" }); // Links to "Security Properties" (Topic 2)
            extraEdges.push({ from: 147, to: 42, label: "Applies to E-Commerce Security Domain", color: "#B0B0B0" }); // Links to "Cybersecurity Domains" (Topic 1)

            //Connections for Introduction to Authentication
            extraEdges.push({ from: 160, to: 47, label: "Builds on Need for Authentication", color: "#B0B0B0" }); // Links to "Security Properties" (Topic 2, Week 1)
            extraEdges.push({ from: 160, to: 61, label: "Relies on Symmetric Key Concepts", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Topic 3.2, Week 2)
            extraEdges.push({ from: 160, to: 80, label: "Involves Public-Key Techniques", color: "#B0B0B0" }); // Links to "Introduction to Public-Key Cryptography" (Topic 4.1, Week 3)
            extraEdges.push({ from: 160, to: 103, label: "Uses Cryptographic Checksums for Integrity", color: "#B0B0B0" }); // Links to "Authenticated Encryption" (Topic 5.4, Week 4)
            extraEdges.push({ from: 160, to: 120, label: "Supports Secure Key Management", color: "#B0B0B0" }); // Links to "Introduction to Secret Key Management" (Topic 6.1, Week 5)
            extraEdges.push({ from: 160, to: 140, label: "Enabled by PKI Trust Models", color: "#B0B0B0" }); // Links to "Introduction to Public Key Infrastructure (PKI)" (Topic 7.1, Week 6)
            extraEdges.push({ from: 160, to: 203, label: "Provides User Verification in Email Security", color: "#B0B0B0" }); // Links to "Security Features and Services of PGP" (Topic 10.4, Week 9)
            extraEdges.push({ from: 160, to: 227, label: "Essential for Malware Countermeasures", color: "#B0B0B0" }); // Links to "Defensive Measures Against Malware" (Topic 11.6, Week 10)

            //Connections for Authentication Methods
            extraEdges.push({ from: 161, to: 123, label: "Depends on Secure Key Agreement Protocols", color: "#B0B0B0" }); // Links to "Key Agreement Protocols" (Topic 6)
            extraEdges.push({ from: 161, to: 142, label: "Supports Digital Identity Verification", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 161, to: 102, label: "Used to Authenticate Message Integrity", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 161, to: 186, label: "Used in IPSec for Peer Authentication", color: "#B0B0B0" }); // Links to "Authentication Methods in IPSec" (Topic 9)
            extraEdges.push({ from: 161, to: 207, label: "Enables Identity Verification in Email Trust Model", color: "#B0B0B0" }); // Links to "PGP Trust Model (Web-of-Trust)" (Topic 10)
            extraEdges.push({ from: 161, to: 227, label: "Counters Unauthorized Software Access", color: "#B0B0B0" }); // Links to "Defensive Measures Against Malware" (Topic 11)

            //Connections for Password-Based Authentication
            extraEdges.push({ from: 162, to: 46, label: "Used to Prevent Identity Spoofing", color: "#B0B0B0" }); // Links to "Cybersecurity Threats" (Topic 2)
            extraEdges.push({ from: 162, to: 62, label: "Works with Block Cipher Authentication", color: "#B0B0B0" }); // Links to "Block Ciphers and Their Design" (Topic 3)
            extraEdges.push({ from: 162, to: 104, label: "May Use HMAC for Integrity Verification", color: "#B0B0B0" }); // Links to "Authenticated Encryption with Associated Data (AEAD)" (Topic 5)
            extraEdges.push({ from: 162, to: 125, label: "Relies on Secure Key Management", color: "#B0B0B0" }); // Links to "Security Considerations in Key Management" (Topic 6)
            extraEdges.push({ from: 162, to: 142, label: "Can Be Integrated with Digital Certificates", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 162, to: 186, label: "Used as Method in IPSec Authentication", color: "#B0B0B0" }); // Links to "Authentication Methods in IPSec" (Topic 9)
            extraEdges.push({ from: 162, to: 227, label: "Vulnerable to Keyloggers and Malware", color: "#B0B0B0" }); // Links to "Defensive Measures Against Malware" (Topic 11)

            //Connections for Challenge-Response Authentication Protocols
            extraEdges.push({ from: 163, to: 61, label: "Requires Strong Cipher Support", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Topic 3)
            extraEdges.push({ from: 163, to: 104, label: "Can Incorporate AEAD for Integrity", color: "#B0B0B0" }); // Links to "Authenticated Encryption with Associated Data (AEAD)" (Topic 5)
            extraEdges.push({ from: 163, to: 125, label: "Can Use Pre-Shared Keys", color: "#B0B0B0" }); // Links to "Security Considerations in Key Management" (Topic 6)
            extraEdges.push({ from: 163, to: 142, label: "Enabled via PKI Credentials", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 163, to: 203, label: "Provides Mutual Authentication", color: "#B0B0B0" }); // Links to "Security Features and Services of PGP" (Topic 10)

            //Connections for Token-Based Authentication
            extraEdges.push({ from: 164, to: 121, label: "Relies on Secure Key Management", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 164, to: 142, label: "Often Uses PKI for Certificate-Based Authentication", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 164, to: 84, label: "Can Use Digital Signatures for Verification", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 164, to: 102, label: "May Include MAC for Token Integrity", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 164, to: 186, label: "Can Be Used as an Authentication Method in IPSec", color: "#B0B0B0" }); // Links to "Authentication Methods in IPSec" (Topic 9)

            //Connections for Enterprise Authentication and Single Sign-On (SSO)
            extraEdges.push({ from: 165, to: 121, label: "Requires Secure Key Distribution for Authentication Tokens", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 165, to: 142, label: "Utilizes Digital Certificates for Federated Identity Verification", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 165, to: 182, label: "Complementary with VPNs for Unified Access Control", color: "#B0B0B0" }); // Links to "Types of VPNs" (Topic 9)
            extraEdges.push({ from: 165, to: 203, label: "Enhances Secure Communication via PGP Email Authentication", color: "#B0B0B0" }); // Links to "Security Features and Services of PGP" (Topic 10)

            //Connections for Authentication in Distributed Environments
            extraEdges.push({ from: 166, to: 121, label: "Requires Secure Key Management Across Nodes", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 166, to: 144, label: "Depends on Certificate-Based Trust Model", color: "#B0B0B0" }); // Links to "Certificate Hierarchies and Trust Models" (Topic 7)
            extraEdges.push({ from: 166, to: 184, label: "Utilized in Secure Remote Access", color: "#B0B0B0" }); // Links to "IP Security (IPSec) Overview" (Topic 9)
            extraEdges.push({ from: 166, to: 142, label: "Uses Digital Certificates to Validate Entities", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 166, to: 227, label: "Mitigates Unauthorized Access via Malware", color: "#B0B0B0" }); // Links to "Defensive Measures Against Malware" (Topic 11)

            //Connections for Introduction to VPNs
            extraEdges.push({ from: 180, to: 64, label: "Uses Symmetric-Key Ciphers for Tunnel Encryption", color: "#B0B0B0" }); // Modes of Encryption (Topic 3)
            extraEdges.push({ from: 180, to: 103, label: "Utilizes Authenticated Encryption for Secure Tunnels", color: "#B0B0B0" }); // Authenticated Encryption (Topic 5)
            extraEdges.push({ from: 180, to: 123, label: "Depends on Secure Session Key Establishment", color: "#B0B0B0" }); // Key Agreement Protocols (Topic 6)
            extraEdges.push({ from: 180, to: 140, label: "Requires PKI for Certificate-Based Authentication", color: "#B0B0B0" }); // Introduction to PKI (Topic 7)
            extraEdges.push({ from: 180, to: 161, label: "Supports Token and Certificate-Based Authentication", color: "#B0B0B0" }); // Authentication Methods (Topic 8)

            //Connections for VPN Technologies
            extraEdges.push({ from: 181, to: 101, label: "Uses Encryption Protocols", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 181, to: 124, label: "Supports Secure Key Distribution", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Topic 6)
            extraEdges.push({ from: 181, to: 141, label: "Utilizes Digital Certificates for Secure Access", color: "#B0B0B0" }); // Links to "PKI Components and Entities" (Topic 7)
            extraEdges.push({ from: 181, to: 161, label: "Requires Authentication Protocols", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)
            extraEdges.push({ from: 181, to: 201, label: "Can Complement Email Security Systems", color: "#B0B0B0" }); // Links to "Comparison of PGP and S/MIME" (Topic 10)

            //Connections for Types of VPNs
            extraEdges.push({ from: 182, to: 124, label: "Uses Symmetric Key Distribution for Secure Channels", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Topic 6)
            extraEdges.push({ from: 182, to: 142, label: "Relies on PKI for Certificate-Based Authentication", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 182, to: 161, label: "Requires Secure User Authentication Mechanisms", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)
            extraEdges.push({ from: 182, to: 81, label: "Secures Communication Using Public-Key Cryptography", color: "#B0B0B0" }); // Links to "Mathematical Foundations of PKC" (Topic 4)
            extraEdges.push({ from: 182, to: 101, label: "Ensures Data Integrity Using Cryptographic Hashes", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)

            //Connections for Security Risks and Benefits of VPNs
            extraEdges.push({ from: 183, to: 124, label: "Requires Strong Key Distribution", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Topic 6)
            extraEdges.push({ from: 183, to: 145, label: "Enhances Security Through PKI Support", color: "#B0B0B0" }); // Links to "PKI in Real-Life Applications" (Topic 7)
            extraEdges.push({ from: 183, to: 160, label: "Authenticated via Entity Verification", color: "#B0B0B0" }); // Links to "Introduction to Authentication" (Topic 8)
            extraEdges.push({ from: 183, to: 102, label: "Uses HMAC for Integrity Protection", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 183, to: 83, label: "Uses Public Key Encryption for Key Exchange", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Topic 4)

            //Connections for IP Security (IPSec) Overview
            extraEdges.push({ from: 184, to: 121, label: "Uses Symmetric Key Management for Secure Channels", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 184, to: 84, label: "Combines with Digital Signatures for Authentication", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 184, to: 102, label: "Ensures Message Integrity with MACs", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 184, to: 61, label: "Encrypts IP Packets Using Symmetric-Key Ciphers", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Topic 3)
            extraEdges.push({ from: 184, to: 141, label: "Relies on PKI for Authentication and Key Exchange", color: "#B0B0B0" }); // Links to "PKI Components and Entities" (Topic 7)
            extraEdges.push({ from: 184, to: 160, label: "Provides Entity Authentication in VPN Setup", color: "#B0B0B0" }); // Links to "Introduction to Authentication" (Topic 8)

            //Connections for IPSec Components and Session Establishment
            extraEdges.push({ from: 185, to: 124, label: "Uses Secure Key Distribution Mechanisms", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Topic 6)
            extraEdges.push({ from: 185, to: 141, label: "Relies on PKI for Key Authentication", color: "#B0B0B0" }); // Links to "PKI Components and Entities" (Topic 7)
            extraEdges.push({ from: 185, to: 164, label: "Supports Token and Key-based Authentication", color: "#B0B0B0" }); // Links to "Token-Based Authentication" (Topic 8)
            extraEdges.push({ from: 185, to: 102, label: "Provides Integrity with MAC Algorithms", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 185, to: 83, label: "Combines with Hybrid Cryptosystems for Secure Exchange", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Topic 4)

            //Connections for Authentication Methods in IPSec
            extraEdges.push({ from: 186, to: 142, label: "Uses Certificates for Peer Verification", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 186, to: 164, label: "Supports Token-Based Methods Like Public Key or Pre-shared Keys", color: "#B0B0B0" }); // Links to "Token-Based Authentication" (Topic 8)
            extraEdges.push({ from: 186, to: 122, label: "Relies on Secure Session Key Exchange", color: "#B0B0B0" }); // Links to "Session Key Establishment" (Topic 6)
            extraEdges.push({ from: 186, to: 102, label: "Enhances Message Authentication", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 186, to: 82, label: "May Use Asymmetric Key Methods", color: "#B0B0B0" }); // Links to "RSA Algorithm" (Topic 4)

            //Connections for IPSec Modes: Transport vs. Tunnel
            extraEdges.push({ from: 187, to: 161, label: "Relies on Authentication Methods", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)
            extraEdges.push({ from: 187, to: 121, label: "Uses Secret Keys for Encryption", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 187, to: 101, label: "Provides Confidentiality and Integrity", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 187, to: 83, label: "Secures with Hybrid Cryptosystems", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Topic 4)
            extraEdges.push({ from: 187, to: 61, label: "Applies Symmetric-Key Encryption", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Topic 3)

            //Connections for IPSec Traffic Security Protocols
            extraEdges.push({ from: 188, to: 122, label: "Depends on Secure Session Key Establishment", color: "#B0B0B0" }); // Links to "Session Key Establishment" (Topic 6)
            extraEdges.push({ from: 188, to: 84, label: "Builds on Digital Signatures for Authentication", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 188, to: 102, label: "Uses HMAC for Integrity Protection", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 188, to: 164, label: "Relies on Token-Based Authentication Methods", color: "#B0B0B0" }); // Links to "Token-Based Authentication" (Topic 8)
            extraEdges.push({ from: 188, to: 142, label: "Integrates with PKI for Secure Key Exchange", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)

            //Connections for IPSec Packet Processing
            extraEdges.push({ from: 189, to: 64, label: "Uses Symmetric Ciphers for Payload Encryption", color: "#B0B0B0" }); // Links to "Modes of Encryption" (Topic 3)
            extraEdges.push({ from: 189, to: 83, label: "Employs Hybrid Cryptosystems in Key Exchange", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Topic 4)
            extraEdges.push({ from: 189, to: 103, label: "Supports Authenticated Encryption Mechanisms", color: "#B0B0B0" }); // Links to "Authenticated Encryption" (Topic 5)
            extraEdges.push({ from: 189, to: 124, label: "Relies on Key Distribution Protocols", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Topic 6)
            extraEdges.push({ from: 189, to: 142, label: "Applies Digital Certificates for Authentication", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 189, to: 161, label: "Involves Challenge-Response Authentication Methods", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)

            //Connections for Combining ESP and AH
            extraEdges.push({ from: 190, to: 103, label: "Uses HMAC from Authenticated Encryption", color: "#B0B0B0" }); // Links to "Authenticated Encryption" (Topic 5)
            extraEdges.push({ from: 190, to: 122, label: "Requires Secure Session Key Establishment", color: "#B0B0B0" }); // Links to "Session Key Establishment" (Topic 6)
            extraEdges.push({ from: 190, to: 142, label: "Authenticated using Digital Certificates", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 190, to: 163, label: "Supports Challenge-Response Authentication", color: "#B0B0B0" }); // Links to "Challenge-Response Authentication Protocols" (Topic 8)
            extraEdges.push({ from: 190, to: 64, label: "Encrypts with Symmetric Modes like CBC", color: "#B0B0B0" }); // Links to "Modes of Encryption" (Topic 3)

            //Connections for Introduction to Email Security
            extraEdges.push({ from: 200, to: 80, label: "Uses PKC for Secure Email", color: "#B0B0B0" }); // Links to "Introduction to Public-Key Cryptography" (Topic 4.1)
            extraEdges.push({ from: 200, to: 47, label: "Provides Confidentiality, Integrity, Authentication", color: "#B0B0B0" }); // Links to "Security Properties" (Topic 2)
            extraEdges.push({ from: 200, to: 84, label: "Relies on Digital Signatures for Authenticity", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4.5)
            extraEdges.push({ from: 200, to: 61, label: "Uses Symmetric Ciphers for Message Encryption", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Topic 3.2)
            extraEdges.push({ from: 200, to: 101, label: "Uses Cryptographic Hashes for Integrity", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5.2)
            extraEdges.push({ from: 200, to: 145, label: "Trust Built on Web-of-Trust or PKI", color: "#B0B0B0" }); // Links to "PKI in Real-Life Applications" (Topic 7.6)
            extraEdges.push({ from: 200, to: 161, label: "Requires Authentication Mechanisms", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8.2)
            extraEdges.push({ from: 200, to: 181, label: "Alternative to Secure Email Tunnels", color: "#B0B0B0" }); // Links to "VPN Technologies" (Topic 9.2)
            extraEdges.push({ from: 200, to: 225, label: "Can Be Targeted by Malware", color: "#B0B0B0" }); // Links to "Types of Malware" (Topic 11.4)

            //Connections for Comparison of PGP and S/MIME
            extraEdges.push({ from: 201, to: 144, label: "Uses Different Trust Models (Web-of-Trust vs PKI)", color: "#B0B0B0" }); // Links to "Certificate Hierarchies and Trust Models" (Topic 7)
            extraEdges.push({ from: 201, to: 84, label: "Applies Digital Signatures for Authentication", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 201, to: 164, label: "Provides Authentication through Certificate or Key-Based Identity", color: "#B0B0B0" }); // Links to "Token-Based Authentication" (Topic 8)
            extraEdges.push({ from: 201, to: 47, label: "Enhances Message Integrity and Confidentiality", color: "#B0B0B0" }); // Links to "Security Properties" (Topic 2)
            extraEdges.push({ from: 201, to: 83, label: "Encrypts Session Keys with Public Keys", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Topic 4)
            extraEdges.push({ from: 201, to: 101, label: "Uses Hash Functions for Message Integrity", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 201, to: 124, label: "Secure Key Management Required for Confidentiality", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Topic 6)

            //Connections for PGP (Pretty Good Privacy) Overview
            extraEdges.push({ from: 202, to: 83, label: "Secures Email & Files using Hybrid Encryption", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Topic 4)
            extraEdges.push({ from: 202, to: 84, label: "Uses Digital Signatures for Integrity & Non-Repudiation", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 202, to: 121, label: "Requires Secure Key Management", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 202, to: 144, label: "Implements Web-of-Trust Model", color: "#B0B0B0" }); // Links to "Certificate Hierarchies and Trust Models" (Topic 7)
            extraEdges.push({ from: 202, to: 161, label: "Requires Entity Authentication for Signing", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)

            //Connections for Security Features and Services of PGP
            extraEdges.push({ from: 203, to: 61, label: "Uses Symmetric-Key Ciphers for Confidentiality", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Topic 3)
            extraEdges.push({ from: 203, to: 101, label: "Provides Integrity via Hash Functions", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 203, to: 102, label: "Employs Message Authentication Codes (MAC)", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 203, to: 122, label: "Involves Session Key Establishment", color: "#B0B0B0" }); // Links to "Session Key Establishment" (Topic 6)
            extraEdges.push({ from: 203, to: 144, label: "Utilizes Certificate Hierarchies and Trust Models", color: "#B0B0B0" }); // Links to "Certificate Hierarchies and Trust Models" (Topic 7)
            extraEdges.push({ from: 203, to: 161, label: "Supports Origin Authentication Methods", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)

            //Connections for PGP Encryption Process
            extraEdges.push({ from: 204, to: 83, label: "Uses Hybrid Cryptosystem with Session Key", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Topic 4)
            extraEdges.push({ from: 204, to: 122, label: "Requires Secure Session Key Distribution", color: "#B0B0B0" }); // Links to "Session Key Establishment" (Topic 6)
            extraEdges.push({ from: 204, to: 82, label: "Uses Public-Key for Key Exchange", color: "#B0B0B0" }); // Links to "RSA Algorithm" (Topic 4)
            extraEdges.push({ from: 204, to: 47, label: "Provides Message Confidentiality and Authentication", color: "#B0B0B0" }); // Links to "Security Properties" (Topic 2)
            extraEdges.push({ from: 204, to: 84, label: "Utilizes Digital Signatures for Integrity", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 204, to: 101, label: "Applies Hashing for Signature Generation", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 204, to: 61, label: "Encrypts Message Content for Confidentiality", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Topic 3)

            //Connections for PGP Message Format
            extraEdges.push({ from: 205, to: 122, label: "Uses Hybrid Encryption for Confidentiality", color: "#B0B0B0" }); // Links to "Session Key Establishment" (Topic 6)
            extraEdges.push({ from: 205, to: 84, label: "Applies Digital Signatures for Authentication", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 205, to: 101, label: "Includes Hash Digest for Message Integrity", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 205, to: 144, label: "Depends on PKI Trust Model for Key Management", color: "#B0B0B0" }); // Links to "Certificate Hierarchies and Trust Models" (Topic 7)
            extraEdges.push({ from: 205, to: 163, label: "Ensures Sender Verification via Digital Signing", color: "#B0B0B0" }); // Links to "Challenge-Response Authentication Protocols" (Topic 8)

            //Connections for PGP Key Management
            extraEdges.push({ from: 206, to: 121, label: "Requires Secure Key Storage and Revocation", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 206, to: 144, label: "Differs from X.509 Certificate-Based Trust", color: "#B0B0B0" }); // Links to "Certificate Hierarchies and Trust Models" (Topic 7)
            extraEdges.push({ from: 206, to: 161, label: "Enables Public Key-Based User Authentication", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)
            extraEdges.push({ from: 206, to: 84, label: "Supports Digital Signatures with Trust Model", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)

            //Connections for PGP Trust Model (Web-of-Trust)
            extraEdges.push({ from: 207, to: 144, label: "Alternative to Hierarchical Trust (PKI)", color: "#B0B0B0" }); // Links to "Certificate Hierarchies and Trust Models" (Topic 7)
            extraEdges.push({ from: 207, to: 166, label: "Supports Decentralized Entity Authentication", color: "#B0B0B0" }); // Links to "Authentication in Distributed Environments" (Topic 8)
            extraEdges.push({ from: 207, to: 101, label: "Relies on Integrity via Hash Functions", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 207, to: 103, label: "Enables Authenticated Encryption", color: "#B0B0B0" }); // Links to "Authenticated Encryption" (Topic 5)
            extraEdges.push({ from: 207, to: 83, label: "Built on Hybrid Cryptosystems", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Topic 4)

            //Connections for PGP Message Transmission and Reception
            extraEdges.push({ from: 208, to: 124, label: "Relies on Key Distribution", color: "#B0B0B0" }); // Links to "Symmetric Key Distribution Protocols" (Topic 6)
            extraEdges.push({ from: 208, to: 145, label: "Secures Emails Using PKC", color: "#B0B0B0" }); // Links to "PKI in Real-Life Applications" (Topic 7)
            extraEdges.push({ from: 208, to: 84, label: "Uses Digital Signatures for Authentication", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 208, to: 103, label: "Encrypts Message Content", color: "#B0B0B0" }); // Links to "Authenticated Encryption" (Topic 5)
            extraEdges.push({ from: 208, to: 166, label: "Counters Message Forgery and Replay", color: "#B0B0B0" }); // Links to "Authentication in Distributed Environments" (Topic 8)
            extraEdges.push({ from: 208, to: 188, label: "Ensures Confidentiality & Integrity", color: "#B0B0B0" }); // Links to "IPSec Traffic Security Protocols" (Topic 9)

            //Connections for Introduction to Software Security
            extraEdges.push({ from: 220, to: 46, label: "Relies on Understanding Threats", color: "#B0B0B0" }); // Links to "Cybersecurity Threats" (Topic 2)
            extraEdges.push({ from: 220, to: 60, label: "Uses Cryptographic Defenses", color: "#B0B0B0" }); // Links to "Introduction to Cryptography" (Topic 3)
            extraEdges.push({ from: 220, to: 104, label: "Uses Hashing for Integrity", color: "#B0B0B0" }); // Links to "Authenticated Encryption with Associated Data (AEAD)" (Topic 5)
            extraEdges.push({ from: 220, to: 121, label: "Depends on Proper Key Storage", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 220, to: 141, label: "Uses Certificates for Trusted Code", color: "#B0B0B0" }); // Links to "PKI Components and Entities" (Topic 7)
            extraEdges.push({ from: 220, to: 160, label: "Needs Strong Authentication", color: "#B0B0B0" }); // Links to "Introduction to Authentication" (Topic 8)

            //Connections for Understanding Malware
            extraEdges.push({ from: 223, to: 47, label: "Targets Confidentiality, Integrity, Availability", color: "#B0B0B0" }); // Links to "Security Properties" (Topic 2)
            extraEdges.push({ from: 223, to: 61, label: "May Exploit Symmetric-Key Cipher Weaknesses", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Topic 3)
            extraEdges.push({ from: 223, to: 101, label: "May Alter or Forge Checksums", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 223, to: 142, label: "Can Compromise Digital Certificates", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 223, to: 163, label: "Bypasses Authentication Protocols", color: "#B0B0B0" }); // Links to "Challenge-Response Authentication Protocols" (Topic 8)
            extraEdges.push({ from: 223, to: 183, label: "Tunnels Malware via VPN Channels", color: "#B0B0B0" }); // Links to "Security Risks and Benefits of VPNs" (Topic 9)
            extraEdges.push({ from: 223, to: 203, label: "Can Compromise Email Security", color: "#B0B0B0" }); // Links to "Security Features and Services of PGP" (Topic 10)

            //Connections for Malware Classification
            extraEdges.push({ from: 224, to: 46, label: "Depends on Attack Methods and Behaviors", color: "#B0B0B0" }); // Links to "Cybersecurity Threats" (Topic 2)
            extraEdges.push({ from: 224, to: 101, label: "Utilizes Cryptographic Tools for Obfuscation", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 224, to: 162, label: "Bypasses Entity Authentication Methods", color: "#B0B0B0" }); // Links to "Password-Based Authentication" (Topic 8)
            extraEdges.push({ from: 224, to: 180, label: "Circumvents VPN Protections", color: "#B0B0B0" }); // Links to "Introduction to VPNs" (Topic 9)
            extraEdges.push({ from: 224, to: 143, label: "Avoids Certificate Revocation Checks", color: "#B0B0B0" }); // Links to "Certificate Revocation Lists (CRLs)" (Topic 7)
            extraEdges.push({ from: 224, to: 62, label: "Injected via Symmetric Ciphers in Malware Payloads", color: "#B0B0B0" }); // Links to "Block Ciphers and Their Design" (Topic 3)
            extraEdges.push({ from: 224, to: 102, label: "Forges Message Authenticators", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)

            //Connections for Types of Malware
            extraEdges.push({ from: 225, to: 84, label: "Enables Execution of Malicious Payloads", color: "#B0B0B0" }); // Links to "Digital Signatures" (Topic 4)
            extraEdges.push({ from: 225, to: 101, label: "Targeted by Hash-Based Integrity Checks", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 225, to: 121, label: "Exploits Poor Key Management", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 225, to: 161, label: "Circumvents Weak Authentication Mechanisms", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)
            extraEdges.push({ from: 225, to: 183, label: "Bypasses VPN Tunnels via Exploits", color: "#B0B0B0" }); // Links to "Security Risks and Benefits of VPNs" (Topic 9)
            extraEdges.push({ from: 225, to: 208, label: "Delivered via Email Attachments", color: "#B0B0B0" }); // Links to "PGP Message Transmission and Reception" (Topic 10)

            //Connections for Advanced Persistent Threats (APTs)
            extraEdges.push({ from: 226, to: 121, label: "Exploits Long-Term Vulnerabilities", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 226, to: 161, label: "Bypasses Authentication Mechanisms", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)
            extraEdges.push({ from: 226, to: 46, label: "Initiated via Social Engineering or Phishing", color: "#B0B0B0" }); // Links to "Cybersecurity Threats" (Topic 2)
            extraEdges.push({ from: 226, to: 184, label: "Uses Encrypted Channels for Stealth", color: "#B0B0B0" }); // Links to "IP Security (IPSec) Overview" (Topic 9)
            extraEdges.push({ from: 226, to: 202, label: "Often Delivered Through Malicious Email Attachments", color: "#B0B0B0" }); // Links to "PGP (Pretty Good Privacy) Overview" (Topic 10)
            extraEdges.push({ from: 226, to: 103, label: "Evades Detection Using Polymorphic Malware", color: "#B0B0B0" }); // Links to "Authenticated Encryption" (Topic 5)
            extraEdges.push({ from: 226, to: 83, label: "Compromises Software to Establish Backdoors", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Topic 4)

            //Connections for Defensive Measures Against Malware
            extraEdges.push({ from: 227, to: 203, label: "Uses Email Security Protocols to Prevent Malware Entry", color: "#B0B0B0" }); // Links to "Security Features and Services of PGP" (Topic 10)
            extraEdges.push({ from: 227, to: 180, label: "Uses Secure Tunnels to Isolate Malware Spread", color: "#B0B0B0" }); // Links to "Introduction to VPNs" (Topic 9)
            extraEdges.push({ from: 227, to: 162, label: "Requires Strong Authentication to Prevent Unauthorized Code Execution", color: "#B0B0B0" }); // Links to "Password-Based Authentication" (Topic 8)
            extraEdges.push({ from: 227, to: 142, label: "Relies on Trusted Certificates to Prevent Malware Execution", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)
            extraEdges.push({ from: 227, to: 121, label: "Enforces Key Protection to Prevent Malware Key Theft", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 227, to: 102, label: "Uses MACs and Hashes to Verify File Integrity", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 227, to: 83, label: "Blocks Executables Without Valid Digital Signatures", color: "#B0B0B0" }); // Links to "Hybrid Cryptosystems" (Topic 4)
            extraEdges.push({ from: 227, to: 64, label: "Encrypts Malware Communications for Analysis", color: "#B0B0B0" }); // Links to "Modes of Encryption" (Topic 3)
            extraEdges.push({ from: 227, to: 46, label: "Mitigates Malware through Fundamental Threat Awareness", color: "#B0B0B0" }); // Links to "Cybersecurity Threats" (Topic 2)

            //Connections for Understanding Buffer Overflows
            extraEdges.push({ from: 228, to: 82, label: "Exploits Memory Safety Flaws in Code", color: "#B0B0B0" }); // Links to "RSA Algorithm" (Topic 4)
            extraEdges.push({ from: 228, to: 102, label: "Violates Integrity with Unchecked Inputs", color: "#B0B0B0" }); // Links to "Message Authentication Codes (MAC)" (Topic 5)
            extraEdges.push({ from: 228, to: 125, label: "Can Bypass Key Protections if Mismanaged", color: "#B0B0B0" }); // Links to "Security Considerations in Key Management" (Topic 6)
            extraEdges.push({ from: 228, to: 162, label: "Evades Authentication by Overwriting Return Addresses", color: "#B0B0B0" }); // Links to "Password-Based Authentication" (Topic 7)

            //Connections for Program Memory Layout
            extraEdges.push({ from: 229, to: 166, label: "Requires Precise Memory Layout Knowledge", color: "#B0B0B0" }); // Links to "Authentication in Distributed Environments" (Topic 8)
            extraEdges.push({ from: 229, to: 125, label: "Impacts Key Security Protocols", color: "#B0B0B0" }); // Links to "Security Considerations in Key Management" (Topic 6)
            extraEdges.push({ from: 229, to: 104, label: "Bypasses Encryption Safeguards", color: "#B0B0B0" }); // Links to "Authenticated Encryption with Associated Data (AEAD)" (Topic 5)
            extraEdges.push({ from: 229, to: 65, label: "Circumvents Cryptographic Protections", color: "#B0B0B0" }); // Links to "Security Considerations" (Topic 3)

            //Connections for Stack-Based Buffer Overflow Attacks
            extraEdges.push({ from: 230, to: 166, label: "Exploits Weak Authentication in Legacy Systems", color: "#B0B0B0" }); // Links to "Authentication in Distributed Environments" (Topic 8)
            extraEdges.push({ from: 230, to: 101, label: "Violates Message Integrity and Can Lead to Arbitrary Code Execution", color: "#B0B0B0" }); // Links to "Cryptographic Hash Functions" (Topic 5)
            extraEdges.push({ from: 230, to: 61, label: "Undermines Confidentiality via Memory Disclosure", color: "#B0B0B0" }); // Links to "Symmetric-Key Ciphers" (Topic 3)
            extraEdges.push({ from: 230, to: 46, label: "Targets Vulnerabilities Leading to Confidentiality and Availability Breaches", color: "#B0B0B0" }); // Links to "Cybersecurity Threats" (Topic 2)
            extraEdges.push({ from: 230, to: 121, label: "Circumvents Key Storage Protections via Stack Exploits", color: "#B0B0B0" }); // Links to "Key Management Issues" (Topic 6)
            extraEdges.push({ from: 230, to: 142, label: "Bypasses Certificate Validation in Poorly Secured Applications", color: "#B0B0B0" }); // Links to "Digital Certificates" (Topic 7)

            //Connections for Buffer Overflow Exploitation Techniques
            extraEdges.push({ from: 231, to: 161, label: "Exploits Authentication Weaknesses", color: "#B0B0B0" }); // Links to "Authentication Methods" (Topic 8)
            extraEdges.push({ from: 231, to: 103, label: "Bypasses Integrity Protections", color: "#B0B0B0" }); // Links to "Authenticated Encryption" (Topic 5)
            extraEdges.push({ from: 231, to: 47, label: "Violates Integrity and Availability", color: "#B0B0B0" }); // Links to "Security Properties" (Topic 2)
            extraEdges.push({ from: 231, to: 125, label: "Undermines Key Confidentiality", color: "#B0B0B0" }); // Links to "Security Considerations in Key Management" (Topic 6)

            //Connections for Defenses Against Buffer Overflow Attacks
            extraEdges.push({ from: 232, to: 166, label: "Uses Strong Authentication to Prevent Exploitation", color: "#B0B0B0" }); // Links to "Authentication in Distributed Environments" (Topic 8)
            extraEdges.push({ from: 232, to: 125, label: "Depends on Secure Key Handling to Limit Exploit Impact", color: "#B0B0B0" }); // Links to "Security Considerations in Key Management" (Topic 6)
            extraEdges.push({ from: 232, to: 104, label: "May Use AEAD to Ensure Integrity of Inputs", color: "#B0B0B0" }); // Links to "Authenticated Encryption with Associated Data (AEAD)" (Topic 5)
            extraEdges.push({ from: 232, to: 62, label: "Requires Knowledge of Encryption to Understand Overflows in Cipher Implementations", color: "#B0B0B0" }); // Links to "Block Ciphers and Their Design" (Topic 3)
            extraEdges.push({ from: 232, to: 48, label: "Related to Threats of Memory Exploits and Software Vulnerabilities", color: "#B0B0B0" }); // Links to "Achieving Security" (Topic 2)

        }
        createRelations();
        

        let nodeEdgeMap = {};
        let hiddenNodeEdges = {};


        // Ensure all edges have unique IDs and build a map of node -> connected edges
        function buildNodeEdgeMap() {
            let idCounter = 100000; // Some large number to not clash with other IDs
            extraEdges.forEach((edge, index) => {
                // Assign a unique ID if missing
                if (!edge.id) {
                    edge.id = `auto-${idCounter++}`;
                }

                [edge.from, edge.to].forEach(nodeId => {
                    if (!nodeEdgeMap[nodeId]) nodeEdgeMap[nodeId] = [];
                    nodeEdgeMap[nodeId].push(edge);
                });
            });
        }
        buildNodeEdgeMap();
        hiddenNodeEdges = {...nodeEdgeMap};


        function updateGraph(view) {
            circularButton.classList.remove("active");
            timelineButton.classList.remove("active");
            if (view === "circular") {
                createCircularGraph();
                circularButton.classList.add("active");
            } else {
                createTimelineGraph();
                timelineButton.classList.add("active");
            }
            network.setData({ nodes: nodes, edges: edges });

            if (extraEdgesVisible) {
                edges.add(extraEdges);
            }
            
        }



        createCircularGraph();



        var network = new vis.Network(container, { nodes: nodes, edges: edges }, { physics: false });
        //Handle all on click logic

        const groupPresets = {
            "group1":  { "color": "#FF4136", "shape": "\uf111" }, // Red circle
            "group2":  { "color": "#0074D9", "shape": "\uf0c8" }, // Blue square
            "group3":  { "color": "#2ECC40", "shape": "\uf069" }, // Green asterisk
            "group4":  { "color": "#FFDC00", "shape": "\uf005" }, // Yellow star
            "group5":  { "color": "#B10DC9", "shape": "\uf140" }, // Purple bullseye
            "group6":  { "color": "#FF851B", "shape": "\uf04d" }, // Orange stop block
            "group7":  { "color": "#AAAAAA", "shape": "\uf2b4" }, // Gray flag
            "group8":  { "color": "#F012BE", "shape": "\uf02b" }, // Pink tag
            "group9":  { "color": "#39CCCC", "shape": "\uf0d8" }, // Teal triangle up
            "group10": { "color": "#85144b", "shape": "\uf0e9" }  // Maroon Umbrella
        };

        let groups = {
            "group1":  [],
            "group2":  [],
            "group3":  [],
            "group4":  [],
            "group5":  [],
            "group6":  [],
            "group7":  [],
            "group8":  [],
            "group9":  [],
            "group10": []
        };
        let nodeTagsDictionary = {}
        const tagYOffset=110;
        const tagSize = 80;
        let tagStartingIdBase = 100000;

        function moveTagAboveParents(params)
        {
            let draggedNodeId = params.nodes[0];
            const pos = network.getPositions([draggedNodeId])[draggedNodeId];
            
            if (nodeTagsDictionary[draggedNodeId]) //If node has tags
            { 
                for (const key in nodeTagsDictionary[draggedNodeId]) {
                  let tagId = nodeTagsDictionary[draggedNodeId][key];
                  let nodeData = nodes.get(tagId);

                  nodes.update(
                  {
                    id: tagId,
                    x: pos.x + nodeData.hiddenInfo["xOffset"],
                    y: pos.y - tagYOffset
                  });
                }
            }

        }
        network.on("dragEnd", moveTagAboveParents);

        function giveTag(nodeId, groupPreset, groupNum){
            const pos = network.getPositions([nodeId])[nodeId];
            let idForTag = tagStartingIdBase;
            tagStartingIdBase += 1;
            
            if (!nodeTagsDictionary[nodeId]) { //If node does not have a list(first tag)
                nodeTagsDictionary[nodeId] = {};
            }

            let tagNum = Object.keys(nodeTagsDictionary[nodeId]).length;

            const tagXOffsetMultiplier = 50; //Calculate tag offset so tags are not on top of each other
            let tagXOffsetNegative = (tagNum%2 == 0) ? 1:-1 ;
            let tagXOffset = tagXOffsetMultiplier*tagNum*tagXOffsetNegative;
            if (tagNum%2==1) tagXOffset -= tagXOffsetMultiplier;

            nodes.add({ 
                id: idForTag,
                x: pos.x + tagXOffset,
                y: pos.y - tagYOffset, 
                shape: "icon",
                icon: 
                {
                    face: "FontAwesome",
                    color: groupPreset["color"],
                    size: tagSize,
                    code: groupPreset["shape"]
                },
                hiddenInfo: 
                {
                    xOffset: tagXOffset
                }
            });
            

            nodeTagsDictionary[nodeId][groupNum] = idForTag;//Add tag nodeId

        }

        function removeTag(nodeId, groupNum){
            nodes.remove(nodeTagsDictionary[nodeId][groupNum])
            delete nodeTagsDictionary[nodeId][groupNum];
        }


        //TAGGING
        network.on("click", function (params) {
            if (params.nodes.length !== 1) return; //Check if click is on node, if not, exits

            const nodeId = params.nodes[0];
            const connectedEdges = nodeEdgeMap[nodeId];
            if (!connectedEdges) {
                return
            }

            if (hiddenNodeEdges[nodeId]) {
                // Restore previously hidden edges
                edges.add(hiddenNodeEdges[nodeId]);
                delete hiddenNodeEdges[nodeId];
            } else {
                var connectionIds = network.getConnectedNodes(nodeId);
                // Hide edges by ID and save them for later
                hiddenNodeEdges[nodeId] = connectedEdges;
                const edgeIds = connectedEdges.map(e => e.id);
                edges.remove(edgeIds);
            }

            const nodeLowerBound = 40; //Ids for leaf nodes, only highlight these, not week nodes
            const nodeUpperBound = 240;
            const clickedNodeId = params.nodes[0];

            if (clickedNodeId<40 || clickedNodeId>240) return; //Check if clicked node is leaf

            let clickedOnParentNode = false;
            let removalGroupNumber = 0;


            for (let groupNum = 1;groupNum<=10;groupNum++){
                if (groups["group"+groupNum.toString()][0]===clickedNodeId) {
                    clickedOnParentNode = true;
                    removalGroupNumber = groupNum;
                    break;
                }
            }

            if (clickedOnParentNode) //Run code for removing group and tags
            {
                let kidNodes = connectionIds; //Get connected nodes
                kidNodes.forEach(function(nodeId) //Add connected nodes to group and give them the group tag
                { 
                    if (nodeId>=40 && nodeId<=240) //Only if leaf node
                    {
                        removeTag(nodeId,removalGroupNumber); 
                    }
                });
                groups["group"+removalGroupNumber.toString()] = []
                //nodes.add({ id: topicId, label: topic, color: "#f9f6cf", size: 25, font: { size: 30, color:"#1C1C1C" }, x: topicX, y: topicY });
                nodes.update({    //Change parent node border color
                        id: clickedNodeId,
                        color: {color:"#f9f6cf", border: "#d9d6ae",highlight: {border: "#d9d6ae"}},
                        borderWidth: 1.3, 
                        size: 25
                    });
            }
            else //Run code for making group and tags
            {

                let groupCapacityFull = true;           //Check if there are already 10 groups            
                for (let groupNum = 1;groupNum<=10;groupNum++){
                    if (groups["group"+groupNum.toString()].length===0) {
                        groupCapacityFull = false;
                        emptyGroupNumber = groupNum;
                        groupNumberStr = "group"+emptyGroupNumber.toString();
                        break;
                    }
                }


                if (groupCapacityFull) { //Pop up message if 10 groups exist
                    Swal.fire({
                      icon: 'error',
                      title: 'Maximum 10 groups!',
                      text: 'A maximum of 10 groups allowed at a time, please unselect one of the groups before making another one',
                    });
                    return;
                }

                //Add father node to group list, then all kids
                let groupPreset = groupPresets[groupNumberStr] // Choose style of tags
                groups[groupNumberStr].push(clickedNodeId) // Add node to group
                let kidNodes = network.getConnectedNodes(clickedNodeId); //Get connected nodes

                kidNodes.forEach(function(nodeId) { //Add connected nodes to group and give them the group tag
                    if (nodeId>=40 || nodeId>=240)  //Only if leaf node
                    {
                        groups[groupNumberStr].push(nodeId)
                        giveTag(nodeId, groupPreset, emptyGroupNumber);
                    }
                });

                var nodeData = nodes.get(clickedNodeId)
                nodes.update({ //Change parent node border color
                        id: clickedNodeId,
                        color: (nodeData.color && typeof nodeData.color === "object")
                                 ? { ...nodeData.color, border: groupPreset["color"],highlight:{border:groupPreset["color"]} }  // keep other colors, change border
                                 : { border: groupPreset["color"],highlight:{border:groupPreset["color"]}  },                    // if no object, just set border
                        borderWidth: 1.5,
                        size: Math.round((nodeData.size || 25) * 1.3)        // increase node radius by ~30%
                    });

            }
            


        });



        toggleExtraButton.addEventListener("click", function () {
            toggleExtraButton.classList.toggle('active');
            extraEdgesVisible = !extraEdgesVisible;
            if (extraEdgesVisible) {
              edges.add(extraEdges);
            } else {
              // Remove the extra edges by ID
              const extraEdgeIds = extraEdges.map(edge => edge.id);
              edges.remove(extraEdgeIds);
            }
          });
        circularButton.addEventListener("click", () => updateGraph("circular"));
        timelineButton.addEventListener("click", () => updateGraph("timeline"));
    });
    </script>
</body>
</html>
